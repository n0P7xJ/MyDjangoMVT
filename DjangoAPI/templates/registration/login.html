{% extends 'base.html' %}
{% load static %}
{% load socialaccount %}

{% block title %}Вхід - Django MVT{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/registration.css' %}">
{% endblock %}

{% block content %}
<div class="row justify-content-center mt-5" data-recaptcha-site-key="{{ RECAPTCHA_SITE_KEY }}">
    <div class="col-md-6 col-lg-5">
        <div class="card shadow">
            <div class="card-header bg-primary text-white text-center py-4">
                <h3 class="mb-0">
                    <i class="fas fa-sign-in-alt me-2"></i>
                    Увійти в акаунт
                </h3>
            </div>
            
            <div class="card-body p-4">
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                        </div>
                    {% endfor %}
                {% endif %}

                <form id="login-form" method="post">
                    {% csrf_token %}
                    
                    {% include 'registration/components/group_input.html' with field_name='username' label='Ім\'я користувача' field_type='text' required=True %}
                    
                    {% include 'registration/components/group_input.html' with field_name='password' label='Пароль' field_type='password' required=True %}
                    
                    {% if form.errors %}
                        <div class="alert alert-danger">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            Невірне ім'я користувача або пароль.
                        </div>
                    {% endif %}
                    
                    <!-- Cloudflare Turnstile CAPTCHA -->
                    {% if RECAPTCHA_SITE_KEY %}
                    <div class="cf-turnstile my-3" data-sitekey="{{ RECAPTCHA_SITE_KEY }}" data-theme="light"></div>
                    {% endif %}
                    
                    <button type="submit" class="btn btn-primary w-100 mt-3">
                        <i class="fas fa-sign-in-alt me-2"></i>Увійти
                    </button>
                    
                    <div class="divider my-4">
                        <span class="divider-text">або</span>
                    </div>
                    
                    <!-- Google Sign-In Button -->
                    <a href="{% provider_login_url 'google' %}" class="btn btn-google w-100 mb-3">
                        <svg class="google-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="20px" height="20px">
                            <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"/>
                            <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"/>
                            <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"/>
                            <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z"/>
                        </svg>
                        <span class="ms-2">Увійти через Google</span>
                    </a>
                    
                    <a href="{% url 'users:register' %}" class="btn btn-outline-info w-100">
                        <i class="fas fa-user-plus me-2"></i>Створити новий акаунт
                    </a>
                </form>

                <div class="text-center mt-4 pt-3 border-top">
                    <a href="{% url 'users:password-reset' %}" class="text-muted small">
                        <i class="fas fa-question-circle me-1"></i>Забули пароль?
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

{% include 'registration/components/loading.html' %}

<!-- Cloudflare Turnstile script -->
<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>

{% endblock %}

{% block extra_js %}
<script src="{% static 'js/registration.js' %}"></script>
{% endblock %}
